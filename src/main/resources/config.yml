# ================================================================
# DrcomoVEX - 基于直觉设计的服务器变量管理系统
# 版本: 1.0.0 (代号: 直觉)
# 作者: BaiMo
# ================================================================

# 数据库配置
database:
  # 数据库类型: sqlite 或 mysql
  type: "sqlite"

  # SQLite 配置
  file: "drcomovex.db"

  # MySQL 配置
  mysql:
    host: "localhost"
    port: 3306
    database: "drcomovex"
    username: "root"
    password: "password"
    useSSL: false

  # 连接池配置（针对持久化超时问题优化）
  pool:
    minimum-idle: 3
    maximum-pool-size: 12
    connection-timeout: 15000
    idle-timeout: 300000
    max-lifetime: 900000

# 数据保存配置
data:
  # 是否启用自动保存
  auto-save: true

  # 保存间隔（分钟）
  save-interval-minutes: 3

  # 玩家退出时是否保存数据
  save-on-player-quit: true

# 周期性重置配置
cycle:
  # 是否启用周期性重置
  enabled: true

  # 检查间隔（秒）- 设为 1 秒以确保不错过任何重置时间点
  check-interval-seconds: 1

  # 时区设置
  timezone: "Asia/Shanghai"

  # 初始延迟（秒）：SQLite 环境建议 5 秒，MySQL 可为 0
  initial-delay-seconds: 5

  # 数据库相关参数（仅影响周期任务中的只读查询）
  db:
    max-concurrency: 2      # 并发查询上限
    timeout-millis: 8000    # 读超时（毫秒），SQLite 建议更长以避开热重载初期波动

# 基本设置
settings:
  # 是否检查更新
  check-updates: true

  # 是否通知 OP 更新
  notify-ops: true

  # 入服兜底刷新（多子服共库建议开启）
  # - 玩家进入服务器后，延迟一段时间清理关键变量的本服缓存并为该玩家预热，避免跨服旧缓存导致的“看起来未刷新”
  # - 仅在本服执行，不会写入数据库；若 keys 为空则自动筛选“玩家作用域且带周期”的变量
  join-refresh:
    enabled: true              # 是否启用入服兜底刷新（仅失效缓存与预热，不删除内存，不写库）
    delay-millis: 800          # 入服后延迟执行毫秒数
    max-keys: 32               # 单次处理的最大变量键数量
    cooldown-seconds: 60       # 同一玩家冷却（秒）
    preheat: false             # 是否在失效缓存后对目标键进行预热（异步只读）
    keys: []                   # 可选：指定兜底刷新键清单（留空则自动筛选）

# 调试配置
debug:
  # 日志级别: DEBUG, INFO, WARN, ERROR
  level: "INFO"

